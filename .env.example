# ===========================================
# Nano Banana Lab - Environment Configuration
# ===========================================

# ===========================================
# Application Settings
# ===========================================

# Environment: development, staging, production
ENVIRONMENT=development

# Enable debug mode (enables hot-reload, detailed errors)
DEBUG=true

# Secret key for JWT tokens (CHANGE IN PRODUCTION!)
# Generate with: openssl rand -hex 32
SECRET_KEY=change-me-in-production-use-a-long-random-string

# ===========================================
# Server Configuration
# ===========================================

# API server host and port
HOST=0.0.0.0
PORT=8000

# ===========================================
# Redis (Required)
# ===========================================

# Redis connection URL
# Format: redis://[password@]host:port/db
REDIS_URL=redis://localhost:6379/0

# Maximum Redis connections in pool
REDIS_MAX_CONNECTIONS=10

# ===========================================
# PostgreSQL Database (Optional)
# ===========================================
# Enable database for persistent storage of history, chat sessions, etc.
# If disabled, falls back to file-based storage (history.json)

# Enable database features
DATABASE_ENABLED=false

# PostgreSQL connection URL
# Format: postgresql+asyncpg://user:password@host:port/dbname
DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/idea_generator

# Connection pool settings
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10

# Echo SQL statements (debug only)
DB_ECHO=false

# ===========================================
# AI Provider Configuration
# ===========================================
# Configure one or more AI providers for image generation.
# At least one provider must be configured.

# --- Google Gemini (Default Provider) ---
# Get your key at: https://aistudio.google.com/app/apikey
PROVIDER_GOOGLE_ENABLED=true
PROVIDER_GOOGLE_API_KEY=your_google_api_key_here
PROVIDER_GOOGLE_PRIORITY=1

# --- OpenAI GPT-Image / DALL-E ---
# Supports third-party proxies like OpenRouter, OneAPI, etc.
PROVIDER_OPENAI_ENABLED=false
PROVIDER_OPENAI_API_KEY=
PROVIDER_OPENAI_BASE_URL=
PROVIDER_OPENAI_REFERER=
PROVIDER_OPENAI_PRIORITY=2
#
# Configuration examples:
#
# 1. Official OpenAI (https://platform.openai.com/api-keys):
#    PROVIDER_OPENAI_API_KEY=sk-xxxxx
#    (leave BASE_URL and REFERER empty)
#
# 2. OpenRouter (https://openrouter.ai):
#    PROVIDER_OPENAI_API_KEY=sk-or-v1-xxxxx
#    PROVIDER_OPENAI_BASE_URL=https://openrouter.ai/api/v1
#    PROVIDER_OPENAI_REFERER=https://your-app.com
#
# 3. Other proxies (OneAPI, etc.):
#    PROVIDER_OPENAI_API_KEY=your_proxy_key
#    PROVIDER_OPENAI_BASE_URL=https://your-proxy.com/v1

# --- FLUX (Black Forest Labs) ---
# Get your key at: https://bfl.ai/
PROVIDER_BFL_ENABLED=false
PROVIDER_BFL_API_KEY=
PROVIDER_BFL_PRIORITY=3

# --- Stability AI ---
# Get your key at: https://platform.stability.ai/
PROVIDER_STABILITY_ENABLED=false
PROVIDER_STABILITY_API_KEY=
PROVIDER_STABILITY_PRIORITY=4

# ===========================================
# Chinese AI Provider Configuration
# ===========================================
# Chinese providers optimized for users in China.
# They typically offer better latency for China users and support
# Chinese language prompts well.

# --- Alibaba (通义万相 / Wanxiang) ---
# Get your key at: https://dashscope.console.aliyun.com/
PROVIDER_ALIBABA_ENABLED=false
PROVIDER_ALIBABA_API_KEY=
PROVIDER_ALIBABA_PRIORITY=10

# --- Zhipu AI (智谱 / CogView) ---
# Get your key at: https://open.bigmodel.cn/
PROVIDER_ZHIPU_ENABLED=false
PROVIDER_ZHIPU_API_KEY=
PROVIDER_ZHIPU_PRIORITY=11

# --- ByteDance (即梦 / Jimeng) ---
# Get your keys at: https://console.volcengine.com/
# Requires both access key and secret key for Volcano Engine authentication
PROVIDER_BYTEDANCE_ENABLED=false
PROVIDER_BYTEDANCE_ACCESS_KEY=
PROVIDER_BYTEDANCE_SECRET_KEY=
PROVIDER_BYTEDANCE_PRIORITY=12

# --- MiniMax ---
# Get your key at: https://platform.minimaxi.com/
PROVIDER_MINIMAX_ENABLED=false
PROVIDER_MINIMAX_API_KEY=
PROVIDER_MINIMAX_GROUP_ID=
PROVIDER_MINIMAX_PRIORITY=13

# ===========================================
# Provider Routing Configuration
# ===========================================

# Default provider for image generation
DEFAULT_IMAGE_PROVIDER=google

# Routing strategy: priority, cost, quality, speed, adaptive, region
# - priority: Use configured priority order
# - cost: Minimize cost
# - quality: Maximize quality
# - speed: Minimize latency
# - adaptive: ML-inspired routing based on historical performance
# - region: Prefer providers in user's region
DEFAULT_ROUTING_STRATEGY=priority

# Enable automatic fallback to other providers on failure
ENABLE_FALLBACK=true

# Fallback order (comma-separated)
FALLBACK_IMAGE_PROVIDERS=google,openai,bfl

# ===========================================
# Video Provider Configuration (Future)
# ===========================================

# --- Runway ---
PROVIDER_RUNWAY_ENABLED=false
PROVIDER_RUNWAY_API_KEY=
PROVIDER_RUNWAY_PRIORITY=1

# --- Kling ---
# Kling requires both access key and secret key for API authentication
PROVIDER_KLING_ENABLED=false
PROVIDER_KLING_API_KEY=
PROVIDER_KLING_SECRET_KEY=
PROVIDER_KLING_PRIORITY=2

# --- Pika Labs ---
PROVIDER_PIKA_ENABLED=false
PROVIDER_PIKA_API_KEY=
PROVIDER_PIKA_PRIORITY=3

# Default provider for video generation
DEFAULT_VIDEO_PROVIDER=runway

# Fallback order for video
FALLBACK_VIDEO_PROVIDERS=runway,kling,pika

# ===========================================
# Storage Configuration
# ===========================================
# Configure where generated images are stored.
# Supports multiple backends: local, minio, oss

# Storage backend: local, minio, oss
# - local: Local file system (development)
# - minio: MinIO or S3-compatible storage (self-hosted)
# - oss: Alibaba Cloud OSS (China production)
STORAGE_BACKEND=minio

# Bucket name (for cloud backends)
STORAGE_BUCKET=nano-banana-images

# Public URL for serving images (CDN)
# If not set, images are served via API proxy
STORAGE_PUBLIC_URL=http://localhost:9000/idea-generator

# Local storage path (STORAGE_BACKEND=local)
STORAGE_LOCAL_PATH=outputs/web

# --- MinIO Configuration (STORAGE_BACKEND=minio) ---
# For self-hosted S3-compatible storage
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=idea-generator
MINIO_USE_SSL=false

# --- Alibaba Cloud OSS (STORAGE_BACKEND=oss) ---
# For China-based production deployments
# Get your keys at: https://ram.console.aliyun.com/
OSS_ENDPOINT=
OSS_ACCESS_KEY=
OSS_SECRET_KEY=

# ===========================================
# Cloudflare R2 Storage (Legacy/Optional)
# For cloud image persistence
# ===========================================

# Enable R2 storage
R2_ENABLED=false

# R2 Account ID
# Find it in Cloudflare Dashboard > R2 > Overview
R2_ACCOUNT_ID=your_account_id_here

# R2 Access Key ID and Secret
# Create at: Cloudflare Dashboard > R2 > Manage R2 API Tokens
R2_ACCESS_KEY_ID=your_access_key_id_here
R2_SECRET_ACCESS_KEY=your_secret_access_key_here

# R2 Bucket Name
R2_BUCKET_NAME=nano-banana-images

# R2 Public URL (for serving images)
# Example: https://images.yourdomain.com
R2_PUBLIC_URL=

# ===========================================
# GitHub OAuth Authentication (Optional)
# For user login and data isolation
# ===========================================

# Enable authentication
AUTH_ENABLED=false

# GitHub OAuth App credentials
# Create at: https://github.com/settings/applications/new
# Callback URL: https://your-domain.com/api/auth/github/callback
GITHUB_CLIENT_ID=your_github_client_id_here
GITHUB_CLIENT_SECRET=your_github_client_secret_here

# OAuth redirect URI (optional, auto-detected if not set)
GITHUB_REDIRECT_URI=


# ===========================================
# CORS Configuration
# ===========================================

# Allowed origins (comma-separated)
# Use "*" for development, specific origins for production
CORS_ORIGINS=*

# ===========================================
# Rate Limiting
# ===========================================

# Enable rate limiting
RATE_LIMIT_ENABLED=true

# Requests per minute per user
RATE_LIMIT_REQUESTS=60

# ===========================================
# Default Generation Settings
# ===========================================

# Default language (en or zh)
DEFAULT_LANGUAGE=en

# Default resolution (1K, 2K, or 4K)
DEFAULT_RESOLUTION=1K

# Default aspect ratio (1:1, 16:9, 9:16, 4:3, 3:4)
DEFAULT_ASPECT_RATIO=16:9

# Default safety level (strict, moderate, relaxed, none)
DEFAULT_SAFETY_LEVEL=moderate

# ===========================================
# Content Safety Filter
# ===========================================

# Enable keyword-based content filter
CONTENT_FILTER_ENABLED=true

# Enable AI-powered content moderation
AI_MODERATION_ENABLED=true

# Additional banned keywords (comma-separated)
BANNED_KEYWORDS=

# ===========================================
# Audit Logging
# ===========================================

# Enable audit logging for content moderation
AUDIT_LOGGING_ENABLED=true

# Enable async upload to R2
AUDIT_ASYNC_UPLOAD=true

# ===========================================
# Logging
# ===========================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
