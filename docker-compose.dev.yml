# Development configuration with hot-reload
# Reuses Redis, PostgreSQL, MinIO from ai-audio-assistant
# Usage: docker-compose -f docker-compose.dev.yml up

services:
  # ============ API Server (Development) ============
  api:
    build: .
    container_name: nano-banana-api-dev
    ports:
      - "8001:8888"
    env_file:
      - .env
    environment:
      - ENVIRONMENT=development
      - DEBUG=true
      # Reuse existing infrastructure (Docker host network)
      - REDIS_URL=redis://host.docker.internal:6379/1
      - DATABASE_ENABLED=true
      - DATABASE_URL=postgresql+asyncpg://user:pass@host.docker.internal:5432/idea_generator
      - MINIO_ENDPOINT=host.docker.internal:9000
      - STORAGE_BACKEND=minio
      - STORAGE_PUBLIC_URL=http://localhost:9000/idea-generator
    volumes:
      - .:/app
      - ./outputs:/app/outputs
    command: uvicorn api.main:app --host 0.0.0.0 --port 8888 --reload
    restart: unless-stopped
